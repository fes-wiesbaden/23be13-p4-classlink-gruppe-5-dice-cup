<!-- Von Lukas bearbeitet -->
<aside class="sidebar">

  <div class="class-filter-block">
    <div class="class-filter">
      <label class="field-label">Klassenauswahl</label>
    <div class="class-filter__row">
      <p-select
        class="class-select"
        [ngModel]="selectedClass"
        (onChange)="classChange.emit($event.value || null)"
          [options]="classOptions"
          placeholder="Bitte auswählen"
          styleClass="class-select"
        ariaLabel="Klassenauswahl"
      ></p-select>
    </div>
    <div class="class-chip-row">
      <span class="chip-label">Aktuelle Klasse</span>
      <span class="chip chip--soft">{{ selectedClass || '23BE13' }}</span>
    </div>
  </div>
  </div>

  <div class="list-header">
    <span>Schüler</span>
    <div class="list-search">
      <span class="search-icon pi pi-search"></span>
      <input
        pInputText
        type="text"
        placeholder="Schueler suchen..."
        [ngModel]="search"
        (ngModelChange)="searchChange.emit($event)"
      />
    </div>
  </div>
  <div class="sidebar__list-wrapper">
    <ul class="sidebar__list">
      <li
        *ngFor="let s of students; trackBy: trackById"
        [class.is-active]="s.id === selectedStudentId"
        (click)="selectStudent.emit(s.id)"
        [hidden]="search && !s.name.toLowerCase().includes(search.toLowerCase())"
      >
        <span class="active-indicator" *ngIf="s.id === selectedStudentId"></span>
        <img
          *ngIf="s.avatarUrl && !isFailed(s.id); else letter"
          class="avatar"
          [src]="s.avatarUrl"
          [alt]="s.name"
          (error)="markFailed(s.id)"
        />
        <ng-template #letter>
          <div class="avatar">{{ s.name.charAt(0) }}</div>
        </ng-template>
        <div class="meta">
          <div class="name">{{ s.name }}</div>
          <div class="class">Klasse {{ s.class }}</div>
        </div>
      </li>
    </ul>
    <div class="list-fade"></div>
  </div>
</aside>
